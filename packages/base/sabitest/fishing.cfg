// fishing hack 

// timing in seconds   - for analysis
// timing in hundreths - for display
_timedelta = 1000
// you can change _timedelta to 1000 (seconds), 100 (tenths), 10 (hundreths) or even 1 (milliseconds)

running = 0
mytime0 = 0
mytimer = [
	if (= $running 1) [
		x = (+ (rnd 8) 1)
		mytime0 = $x
		echo $mytime0
//		showgui fishing
		sleep $_timedelta mytimer
	] [
		echo "stopped"
	]
]

newgui fishing [
	guistayopen [
		guititle "fishing script"
		guitext "Wait for 5" 0
		guibutton "start/stop" [
			if (= $running 0) [
				running = 1
				mytimer
			] [
				sound 90
				running = 0
				if (= $mytime0 5) [
					showgui Success
				] [
					showgui Failure
				]
			]
		] 0
		guibar
		guilist [
			guilist [
				guiimage (concatword packages/base/sabitest/0 ($mytime0) .png) "" 4 0 "packages/base/sabitest/09.png"
			]
		]
	]
]

newgui Success [
	guitext "You caught a trout"
	guimodelpreview (mapmodelname 38) "inventory" [showgui fishing] 4 1
]

newgui Failure [
	guitext "You lost the fish"
	guimodelpreview (mapmodelname 38) "inventory" [showgui fishing] 4 1
]

newgui needbait [
	guitext "You dont have any bait"
	guimodelpreview (mapmodelname 61) "inventory" [cleargui] 4 1
]

//checkshow = [if (>= $mytime0 (div 1000 $_timedelta)) [showgui fishing] [sleep $_timedelta checkshow]]
//sleep $_timedelta checkshow
