// priest script

priestansw = 0
priestques = 0
priestdisp = 25

bribemacro = [
	x = (+ ($priestdisp) (- (rnd 6) (rnd 6)))
	if (> ($x) 0) [
		if (< ($x) 100) [
			priestdisp = $x
		]
	]
]

tauntmacro = [
	if (< ($priestdisp) 25) [
		echo "Your taunt is ignored"
	]
	if (> ($priestdisp) 25) [
		if (> ($priestdisp) 75) [
			x = (- ($priestdisp) (rnd 5))
			priestdisp = $x
		]
		if (> ($priestdisp) 50) [
			x = (- ($priestdisp) (rnd 10))
			priestdisp = $x
		]
		if (< ($priestdisp) 50) [
			x = (- ($priestdisp) (rnd 15))
			priestdisp = $x
		]
	]
]

charmmacro = [
	if (< ($priestdisp) 25) [
		echo "Your charm is ignored"
	]
	if (> ($priestdisp) 25) [
		if (> ($priestdisp) 75) [
			x = (+ ($priestdisp) (rnd 15))
			priestdisp = $x
		]
		if (> ($priestdisp) 50) [
			x = (+ ($priestdisp) (rnd 10))
			priestdisp = $x
		]
		if (< ($priestdisp) 50) [
			x = (+ ($priestdisp) (rnd 5))
			priestdisp = $x
		]
	]
]

newgui persuasion [
	guistayopen [
		guilist [
			guilist [
				guilist [
					guitext "disposition: " 0
					guitext $priestdisp 0
					if (< ($priestdisp) 25) [
						guitext " " "sm1"
					]
					if (> ($priestdisp) 24) [
						guitext " " "sm2"
					]
					if (> ($priestdisp) 49) [
						guitext " " "sm3"
					]
					if (> ($priestdisp) 74) [
						guitext " " "sm4"
					]
				]
				guibar
				guibutton "Bribe 10" [bribemacro; inventorywrite 3 -10 0] 0
				guibutton "Bribe 100" [bribemacro; inventorywrite 3 -100 0] 0
				guibutton "Bribe 1000" [bribemacro; inventorywrite 3 -1000 0] 0
				guibar
				guibutton "Taunt" [tauntmacro; inventorywrite 3 -10 0] 0
				guibar
				guibutton "Charm" [charmmacro; inventorywrite 3 -10 0] 0
				guibar
				guitext " " 0
				guibutton "Back" [showgui priestsayhi] 0
			]
		]
	]
] "Persuasion"

newgui priestsayhi [
	guistayopen [
		guilist [
			guitextbox " " 1 30
			guilist [
				guitextbox "2Priest" 50 0
				guilist [
					guitext "disposition: " 0
					guitext $priestdisp 0
					guitext " " "sm2"
				]
				guibar
				if (= ($priestansw) 0) [
					guitext "Hi there my child, what can I help you with?" "priest"
				]
				if (= ($priestansw) 1) [
					guitext "You need to go see your 5teachers" "priest"
				]
				if (= ($priestansw) 2) [
					guitext "Youll find them in the building to the right of the 5church" "priest"
				]
				if (= ($priestansw) 3) [
					guitext "Its the big 5building  in the center, you cant miss it" "priest"
				]
				if (= ($priestansw) 4) [
					guitext "Are you pulling my leg?!? I dont have time for this" "priest"
				]
				if (= ($priestansw) 5) [
					guitext "You again... what is it now" "priest"
				]
				guibar
				if (>= ($priestques) 1) [
					guitext "4You need to go see your teachers" 0
				]
				if (>= ($priestques) 2) [
					guitext "4Youll find them in the building to the right of the church" 0
				]
				if (>= ($priestques) 3) [
					guitext "4Its the big building in the center, you cant miss it" 0
				]
				if (>= ($priestques) 4) [
					guitext "4Are you pulling my leg?!? I dont have time for this" 0
				]
			]
			guibar
			guitextbox " " 1 20
			guilist [
				guibutton "Persuade" [showgui persuasion] 0
				guibutton "Trade" [showgui shop] 0
				guibar
				guibutton "Work" [priestansw = 1; if (< ($priestques) 1) [priestques = 1]] 0
				if (>= ($priestques) 1) [
					guibutton "Teachers" [priestansw = 2; if (< ($priestques) 2) [priestques = 2]] 0
				]
				if (>= ($priestques) 2) [
					guibutton "Church" [priestansw = 3; if (< ($priestques) 3) [priestques = 3]] 0
				]
				if (>= ($priestques) 3) [
					guibutton "Building" [priestansw = 4; if (< ($priestques) 4) [priestques = 4]] 0
				]
				guibutton "Nevermind" [priestansw = 5; cleargui] 0
			]
		]
	]
] 0
